<!DOCTYPE html>
<html lang="en" style="background-color: black;">
  <head>
    <script type="text/javascript" src="/Assets/MainFunctions.js"></script>
    <script type="text/javascript">WriteHead();</script>
    <title>CatWithCode - TUF GAMING B450-PLUS II NVMe BUG</title>
  </head>
  <body align="left">
    <div id="viewerChecker"> <p><a href="https://catwithcode.moe/Blog/2024.10.02_F_Search_Engines/F_Search_Engines.html">THIS IS A MIRROR OR ARCHIVE. CLICK HERE TO GET TO THE OFFICIAL CATWITHCODE.MOE PAGE! IF YOU ARE ALREADY ON CATWITHCODE.MOE, IGNORE THIS. BLOCKING JAVASCRIPT IS COOL.</a></p> <script type="text/javascript">creatCheckViewer();</script></div>

    <div id="Header"> <a href="/archive.html">NoJS-Header</a> <script type="text/javascript">WriteHeader();</script></div>
    <script type="text/javascript">CreateSpeechBubble("ASUS, more like A SUS.");</script>
    
    <h1>TUF GAMING B450-PLUS II NVMe BUG</h1>
    <p>My husband's PC has this board (BIOS: 4631 - 292156861A336E1F25B66934958F9770F263366C09687F03450F12D99943516D - 2025/04/01), and on Linux it causes heavy and I mean HEAVY stutters and freezes. It has something to do with NVMe and power-saving mode. I fixed it with the following grub boot parameters found on the Arch Wiki. If that affects something we did not try or check IDK.:</p>
    <p>nvme_core.default_ps_max_latency_us=0 pcie_aspm=off pcie_port_pm=off</p>
    <br>
    <a href="https://wiki.archlinux.org/title/Solid_state_drive/NVMe">https://wiki.archlinux.org/title/Solid_state_drive/NVMe</a>
    <br>
    <p>One other helpful thing we found was after swapping a broken SSD a few days ago, is that if you use BTRFS you can check and get broken files in a log (dmesg) and fix them/remove them. We copy'ed some files to an ext4 drive and then back to the new drive with BTRFS and it still found them (The first cheeks the filesystem, the second reports back whats happening and the last, after the check is finished, filters dmesg for the errors (But it can be easily also be read in just the dmesg output - Found by "Mark" at superuser.com)):</p>
    <p>sudo btrfs scrub start /</p>
    <p>sudo btrfs scrub status /</p>
    <p>dmesg | grep "checksum error at" | tail -4 | cut -d\  -f24- | sed 's/.$//'</p>
    <p>dmesg -wH</p>
    <p><u>Update - 2025.05.19</u>: It turns out, besides the broken SDD, his PC also had one bad RAM stick. After swapping/removing the bad RAM module, all issues disappeared EXCEPT for the stuttering. The PC only and I mean ONLY runs fluid on Linux if I add the parameters listed above. Why? I really don't know. We also tried older BIOS versions but nothing changed. 4631 caused some other issues in the Log's while booting, so we tested the BIOS it came with from factory (which was 4401 - 2023/10/23  - 679a99001d98009163387df167269dcc2ac56ded6681421c11f52d25bd498e85). It only was able to be installed when using FlashBack. It worked by rename the File "TB450PS2.CAP" and putting it on my trusted, case-less and kinda damaged FAT16 USB2.0 Stick from the last bios shenanigans I had.</p>
    <br>
    <h2>Sources:</h2>
    <ul>
      <li><a href="https://wiki.archlinux.org/title/Solid_state_drive/NVMe">https://wiki.archlinux.org/title/Solid_state_drive/NVMe</a></li>
      <li><a href="https://superuser.com/questions/858237/">https://superuser.com/questions/858237/</a></li>
      <li><a href="https://superuser.com/a/1000835">https://superuser.com/a/1000835</a></li>
      <li><a href="https://superuser.com/users/234042/mark">https://superuser.com/users/234042/mark</a></li>
      <li><a href="https://www.asus.com/motherboards-components/motherboards/tuf-gaming/tuf-gaming-b450-plus-ii/helpdesk_bios?model2Name=TUF-GAMING-B450-PLUS-II">https://www.asus.com/motherboards-components/motherboards/tuf-gaming/tuf-gaming-b450-plus-ii/helpdesk_bios?model2Name=TUF-GAMING-B450-PLUS-II</a></li>
      <li><a href="../2025.04.21_QFlashPlus_Fix/QFlashPlus_Fix.html">/2025.04.21_QFlashPlus_Fix/QFlashPlus_Fix.html</a></li>
      <li><a href="https://unix.stackexchange.com/questions/95842/">https://unix.stackexchange.com/questions/95842/</a></li>
      <li><a href="https://unix.stackexchange.com/a/95852">https://unix.stackexchange.com/a/95852</a></li>
      <li><a href="https://unix.stackexchange.com/users/1131/maxschlepzig">https://unix.stackexchange.com/users/1131/maxschlepzig</a></li>
    </ul>
    <div id="Footer"> <p><b><u>NoJS-Footer (COULD NOT LOAD LICENSE JS-CODE FOR FOOTER! THE LICENSE IS IN THE HTML CODE!)</u></b></p><script type="text/javascript">WriteFooter('2025.05.19 - 17:30');</script></div>
  </body>
</html>
